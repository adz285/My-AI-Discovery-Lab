<!-- intake.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<script>
  (function () {
    const params = new URLSearchParams(window.location.search);

    // Allow access for testing OR Stripe success param
    const allowPreview = params.get("preview") === "1";
    const allowPaidParam = params.get("paid") === "1";

    // If coming from Stripe success, persist paid status for future visits (refresh/bookmark)
    if (allowPaidParam) {
      try { localStorage.setItem("myaidl_paid_intake", "1"); } catch (e) {}
    }

    // Owner preview mode OR paid param allows access immediately
    if (allowPreview || allowPaidParam) return;

    // Paid flag persisted after Stripe success redirect
    const isPaid = localStorage.getItem("myaidl_paid_intake") === "1";

    if (!isPaid) {
      window.location.replace("/index.html");
    }
  })();
</script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Audit Intake — My AI Discovery Lab</title>
  <meta name="description" content="Complete the AI Discovery Audit intake form so we can begin your audit." />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://myaidiscoverylab.com/intake.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="Audit Intake — My AI Discovery Lab" />
  <meta property="og:description" content="Submit your details to begin the AI Discovery Audit." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://myaidiscoverylab.com/intake.html" />
  <meta property="og:image" content="https://myaidiscoverylab.com/og-image.png" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Audit Intake — My AI Discovery Lab" />
  <meta name="twitter:description" content="Submit your details to begin the AI Discovery Audit." />
  <meta name="twitter:image" content="https://myaidiscoverylab.com/og-image.png" />

  <link rel="icon" href="/favicon.ico" />

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"] },
          boxShadow: {
            glass: "0 12px 34px rgba(0,0,0,.45)",
            glow: "0 0 0 1px rgba(255,255,255,.06), 0 24px 90px rgba(192,38,211,.22)"
          }
        }
      }
    }
  </script>

  <style>
    :root { color-scheme: dark; }
    html, body { overflow-x: hidden; }
    html { scroll-behavior: smooth; }
    body { min-height: 100vh; }
    img { max-width: 100%; height: auto; }

    .bg-animated {
      background:
        radial-gradient(1200px 800px at 12% 10%, rgba(138,43,226,.26), transparent 60%),
        radial-gradient(1000px 760px at 92% 18%, rgba(192,38,211,.18), transparent 58%),
        radial-gradient(900px 700px at 48% 92%, rgba(147,51,234,.16), transparent 55%),
        linear-gradient(180deg, #060510 0%, #04030c 55%, #03020a 100%);
    }

    .glass {
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }
    .glass-strong {
      background: rgba(10,8,22,.52);
      border: 1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }

    .focus-ring:focus-visible {
      outline: none;
      box-shadow: 0 0 0 4px rgba(192,38,211,.28);
    }

    .btn-primary {
      background: linear-gradient(135deg, #8A2BE2 0%, #C026D3 45%, #9333EA 100%);
      box-shadow:
        0 0 0 1px rgba(255,255,255,.08),
        0 14px 44px rgba(192,38,211,.18),
        0 0 42px rgba(147,51,234,.14);
      position: relative;
      overflow: hidden;
    }
    .btn-primary::after {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.18), transparent 40%);
      transform: translateX(-30%);
      opacity: .55;
      transition: opacity .35s ease;
    }
    .btn-primary:hover::after { opacity: .78; }
    .btn-primary:active { transform: translateY(1px); }

    .nav-base {
      background: rgba(0,0,0,.18);
      border-bottom: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transition: background .25s ease, border-color .25s ease;
    }
    .nav-scrolled {
      background: rgba(4,3,10,.72);
      border-bottom: 1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    #particles {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      opacity: .85;
      mix-blend-mode: screen;
    }

    .divider {
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.10), transparent);
      height: 1px;
    }

    /* Inputs to match theme (no layout changes, just consistent surface) */
    .field {
      width: 100%;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 12px 12px;
      color: rgba(255,255,255,.92);
      outline: none;
    }
    .field:focus {
      border-color: rgba(192,38,211,.45);
      box-shadow: 0 0 0 4px rgba(192,38,211,.20);
    }
    .label {
      font-size: 12px;
      color: rgba(228,228,231,.80);
      display: block;
      min-height: 32px;
      line-height: 16px;
    }

    @media (prefers-reduced-motion: reduce) {
      html { scroll-behavior: auto; }
    }
  </style>

  <!-- Lightweight Organization JSON-LD -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"My AI Discovery Lab",
    "url":"https://myaidiscoverylab.com/",
    "email":"audit@myaidiscoverylab.com"
  }
  </script>
</head>

<body class="min-h-screen bg-animated text-zinc-100 font-sans">
  <!-- Background layers -->
  <div class="fixed inset-0 -z-10">
    <canvas id="particles"></canvas>
  </div>

  <!-- Top nav (unchanged structure) -->
  <header id="siteNav" class="sticky top-0 z-50 nav-base">
    <div class="mx-auto max-w-6xl px-4 sm:px-6">
      <div class="flex h-16 items-center justify-between">
        <a href="/index.html#top" class="flex items-center gap-3 min-w-0">
          <div class="h-12 w-12 sm:h-14 sm:w-14 rounded-xl glass shadow-glow flex items-center justify-center overflow-hidden shrink-0 p-1.5">
            <img src="./logo-icon.png" alt="My AI Discovery Lab logo" class="h-full w-full object-contain" loading="eager" decoding="async" />
          </div>
          <div class="leading-tight min-w-0">
            <div class="text-sm font-semibold tracking-tight truncate">My AI Discovery Lab</div>
            <div class="text-[11px] text-zinc-300/80 truncate">AI discovery infrastructure for commerce</div>
          </div>
        </a>

        <nav class="hidden md:flex items-center gap-6 text-sm text-zinc-200/90">
          <a href="/index.html#what" class="hover:text-white transition">What we do</a>
          <a href="/index.html#why" class="hover:text-white transition">Why it matters</a>
          <a href="/index.html#how" class="hover:text-white transition">How it works</a>
          <a href="/index.html#pricing" class="hover:text-white transition">Pricing</a>
          <a href="/index.html#faq" class="hover:text-white transition">FAQ</a>
        </nav>

        <div class="flex items-center gap-3 shrink-0">
          <a href="/index.html#pricing" class="hidden sm:inline-flex rounded-xl px-4 py-2 text-sm glass hover:bg-white/10 transition focus-ring">
            See pricing
          </a>
          <a href="/index.html#pricing" class="inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold text-white btn-primary transition focus-ring whitespace-nowrap">
            Book $149 Audit
          </a>
        </div>
      </div>
    </div>
  </header>

  <main class="relative">
    <section class="mx-auto max-w-6xl px-4 sm:px-6 py-16 sm:py-20">
      <div class="flex min-h-[70vh] items-center justify-center">
        <div class="w-full max-w-2xl glass-strong rounded-3xl p-8 sm:p-10 shadow-glow">
          <div class="flex items-center gap-2 rounded-full glass px-4 py-2 shadow-glass w-fit mx-auto">
            <span class="h-2 w-2 rounded-full" style="background:#C026D3;"></span>
            <span class="text-xs text-zinc-200/90">Audit intake • Required to begin</span>
          </div>

          <h1 class="mt-6 text-3xl sm:text-4xl font-semibold tracking-tight">Audit Intake</h1>
          <p class="mt-3 text-base sm:text-lg text-zinc-200/85 leading-relaxed">
            Provide the details below so we can audit your live product JSON + JSON-LD and deliver your rebuild blueprint.
          </p>

          <div class="mt-6 divider"></div>

          <form
            class="mt-6 space-y-5"
            action="https://formspree.io/f/xdaldprq"
            method="POST"
          >
            <!-- After submission redirect -->
            <input type="hidden" name="_next" value="https://myaidiscoverylab.com/intake-confirmed.html" />
            <input type="hidden" name="_subject" value="New AI Discovery Audit Intake" />
            <input type="hidden" name="submission_source" value="intake_form" />
            <input type="hidden" name="service_type" value="ai_discovery_audit" />
            <input type="hidden" name="lead_stage" value="paid_intake" />
            <input type="hidden" name="source_page" value="/intake.html" />
            <input type="hidden" name="utm_source" value="" />
            <input type="hidden" name="utm_campaign" value="" />
            <input type="hidden" name="utm_medium" value="" />
            <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />
            <input type="hidden" id="payment_verified" name="payment_verified" value="false" />

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="label" for="fullName">Full Name <span class="text-pink-300/90">*</span></label>
                <input class="field mt-2 focus-ring" id="fullName" name="fullName" type="text" required autocomplete="name" />
              </div>

              <div>
                <label class="label" for="email">Email <span class="text-pink-300/90">*</span></label>
                <input class="field mt-2 focus-ring" id="email" name="email" type="email" required autocomplete="email" />
              </div>
            </div>

            <div>
              <label class="label" for="websiteUrl">Website URL <span class="text-pink-300/90">*</span></label>
              <input class="field mt-2 focus-ring" id="websiteUrl" name="websiteUrl" type="url" required placeholder="https://yourstore.com" />
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="label" for="platform">Platform</label>
                <select class="field mt-2 focus-ring" id="platform" name="platform">
                  <option value="Shopify">Shopify</option>
                  <option value="Shopify Plus">Shopify Plus</option>
                  <option value="WooCommerce">WooCommerce</option>
                  <option value="Headless (Hydrogen / Next / Custom)">Headless (Hydrogen / Next / Custom)</option>
                  <option value="Magento">Magento</option>
                  <option value="BigCommerce">BigCommerce</option>
                  <option value="Custom Build">Custom Build</option>
                  <option value="Not sure">Not sure</option>
                </select>
              </div>

              <div>
                <label class="label" for="productUrl">Representative Product URL <span class="text-pink-300/90">*</span></label>
                <input class="field mt-2 focus-ring" id="productUrl" name="productUrl" type="url" required placeholder="https://yourstore.com/products/example" />
              </div>
            </div>

            <!-- New grid block: Revenue + Primary Market -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="label" for="monthlyRevenue">Estimated Monthly Revenue (Optional but recommended)</label>
                <select class="field mt-2 focus-ring" id="monthlyRevenue" name="monthlyRevenue">
                  <option value="Pre-revenue">Pre-revenue</option>
                  <option value="£0–£10K">£0–£10K</option>
                  <option value="£10K–£50K">£10K–£50K</option>
                  <option value="£50K–£250K">£50K–£250K</option>
                  <option value="£250K+">£250K+</option>
                </select>
              </div>

              <div>
                <label class="label" for="primaryMarket">Primary Market</label>
                <select class="field mt-2 focus-ring" id="primaryMarket" name="primaryMarket">
                  <option value="UK">UK</option>
                  <option value="US">US</option>
                  <option value="EU">EU</option>
                  <option value="International">International</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>

            <!-- New operational fields -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="label" for="passwordProtected">Is your storefront password protected? <span class="text-pink-300/90">*</span></label>
                <select class="field mt-2 focus-ring" id="passwordProtected" name="passwordProtected" required>
                  <option value="" disabled selected>Select one</option>
                  <option value="Yes">Yes</option>
                  <option value="No">No</option>
                </select>
              </div>

              <div>
                <label class="label" for="liveProductsCount">Approximate number of live products <span class="text-pink-300/90">*</span></label>
                <select class="field mt-2 focus-ring" id="liveProductsCount" name="liveProductsCount" required>
                  <option value="" disabled selected>Select one</option>
                  <option value="1–10">1–10</option>
                  <option value="10–50">10–50</option>
                  <option value="50–200">50–200</option>
                  <option value="200+">200+</option>
                </select>
              </div>
            </div>

            <div>
              <label class="label" for="notes">Additional Notes</label>
              <textarea class="field mt-2 focus-ring min-h-[120px]" id="notes" name="notes" placeholder="Anything we should know (collections to prioritise, variants complexity, international pricing, etc.)"></textarea>
            </div>

            <div class="flex flex-col sm:flex-row gap-3 pt-2">
              <button
                type="submit"
                class="w-full inline-flex items-center justify-center rounded-xl px-6 py-3 font-semibold text-white btn-primary transition focus-ring"
              >
                Submit Intake
              </button>

              <a
                href="/index.html"
                class="w-full inline-flex items-center justify-center rounded-xl px-6 py-3 font-semibold glass hover:bg-white/10 transition focus-ring"
              >
                Back to site
              </a>
            </div>

            <div class="mt-4 text-xs text-zinc-300/70 break-words text-center">
              Questions? <a class="hover:text-white transition" href="mailto:audit@myaidiscoverylab.com">audit@myaidiscoverylab.com</a>
              <span class="mx-2">•</span>
              One-time audit. No contract.
            </div>
          </form>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Nav blur/darken on scroll
    const nav = document.getElementById("siteNav");
    const onScroll = () => {
      if (window.scrollY > 12) nav.classList.add("nav-scrolled");
      else nav.classList.remove("nav-scrolled");
    };
    window.addEventListener("scroll", onScroll, { passive: true });
    onScroll();

    // Starfield particles (same lightweight approach)
    const canvas = document.getElementById("particles");
    const ctx = canvas.getContext("2d", { alpha: true });

    let w, h, dpr, particles;
    const PARTICLE_COUNT = 110;
    const MAX_SPEED = 0.18;

    function resizeCanvas() {
      dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      w = canvas.clientWidth = window.innerWidth;
      h = canvas.clientHeight = window.innerHeight;
      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      particles = Array.from({ length: PARTICLE_COUNT }, () => spawnParticle(true));
    }

    function spawnParticle(randomY = false) {
      const x = Math.random() * w;
      const y = randomY ? Math.random() * h : -10;
      const r = 0.5 + Math.random() * 1.5;
      const vx = (Math.random() - 0.5) * MAX_SPEED;
      const vy = (0.03 + Math.random() * 0.14);
      const a = 0.14 + Math.random() * 0.32;
      return { x, y, r, vx, vy, a };
    }

    function drawStars() {
      ctx.clearRect(0, 0, w, h);

      const g = ctx.createRadialGradient(w * 0.55, h * 0.15, 0, w * 0.55, h * 0.15, Math.max(w, h));
      g.addColorStop(0, "rgba(192,38,211,0.06)");
      g.addColorStop(1, "rgba(0,0,0,0)");
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, w, h);

      for (let i = 0; i < particles.length; i++) {
        const p = particles[i];
        p.x += p.vx;
        p.y += p.vy;

        if (p.y > h + 12) particles[i] = spawnParticle(false);
        if (p.x < -12) p.x = w + 12;
        if (p.x > w + 12) p.x = -12;

        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255,255,255,${p.a})`;
        ctx.fill();
      }

      for (let i = 0; i < particles.length; i++) {
        for (let j = i + 1; j < particles.length; j++) {
          const a = particles[i], b = particles[j];
          const dx = a.x - b.x, dy = a.y - b.y;
          const dist = Math.sqrt(dx*dx + dy*dy);
          if (dist < 110) {
            const alpha = (1 - dist / 110) * 0.06;
            ctx.strokeStyle = `rgba(138,43,226,${alpha})`;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
            ctx.stroke();
          }
        }
      }

      requestAnimationFrame(drawStars);
    }

    window.addEventListener("resize", resizeCanvas, { passive: true });
    resizeCanvas();
    drawStars();
  </script>

  <!-- Payment gate (run before form validation) -->
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const paid = params.get("paid") === "1";
      const preview = params.get("preview") === "1";

      // Only set tracking flags here — gating/redirect is handled in the <head> script
      if (paid) {
        try { localStorage.setItem("myaidl_paid_intake", "1"); } catch (e) {}
      }

      const pv = document.getElementById("payment_verified");
      if (pv && (paid || preview)) pv.value = "true";
    })();
  </script>

  <!-- URL normaliser + validation (add ONCE) -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector("form");
      const websiteField = document.getElementById("websiteUrl");
      const productField = document.getElementById("productUrl");

      if (!form || !websiteField || !productField) return;

      function normalizeUrl(input) {
        let value = (input.value || "").trim();
        if (value && !/^https?:\/\//i.test(value)) value = "https://" + value;
        input.value = value;
      }

      function isValidUrl(value) {
        try {
          const u = new URL(value);
          return !!u.hostname && u.hostname.includes(".");
        } catch {
          return false;
        }
      }

      websiteField.addEventListener("blur", () => normalizeUrl(websiteField));
      productField.addEventListener("blur", () => normalizeUrl(productField));

      form.addEventListener("submit", (e) => {
        normalizeUrl(websiteField);
        normalizeUrl(productField);

        const websiteValue = websiteField.value.trim();
        const productValue = productField.value.trim();

        if (!isValidUrl(websiteValue) || !isValidUrl(productValue)) {
          e.preventDefault();
          alert("Please enter valid full URLs (e.g. https://example.com).");
          return;
        }

        if (websiteValue.length < 10 || productValue.length < 10) {
          e.preventDefault();
          alert("URL looks incomplete. Please check and try again.");
        }
      });
    });
  </script>
</body>
</html>